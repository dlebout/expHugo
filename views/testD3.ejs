
<html lang="en">
<head>
    <meta charset="utf-8" />

</head>
  <body>
    <span style="margin:100 0 0 2000">frequency:</span><input type="range" min="2" max="100" value="10" id="frequencySlider" style="margin:10 0 0 20"></br>
    <span style="margin:100 0 0 2000">speed:</span><input type="range" min="0.5" max="40" value="4" id="speedSlider" style="margin:10 0 0 20"></br>
    <span style="margin:100 0 0 2000">pattern:</span><input type="range" min="1" max="5" value="1" id="patternSlider" style="margin:10 0 0 20"></br>
    <span style="margin:100 0 0 2000">color:</span><input type="range" min="1" max="6" value="1" id="colorSlider" style="margin:10 0 0 20"></br>
    <span style="margin:100 0 0 2000">size:</span><input type="range" min="1" max="20" value="4" id="sizeSlider" style="margin:10 0 0 20"></br>
    <svg id=canvas width=2000 height=1600></svg>
  </body>
  <script src="lib/d3.v4.js"></script>
  <script src="lib/jquery.min.js"></script>
  <script src="lib/Flownet_d3.js"></script>

	<script>

/*  var graph = {}
  var lines = []
  var dot = []
  randx1 = 100 + Math.random()*1800
  randy1 = 100 + Math.random()*1400
  dot.push({x:randx1, y:randy1, r:5})
  for (var i = 0; i < 40; i++) {
    randx2 = 100 + Math.random()*1800
    randy2 = 100 + Math.random()*1400
    interx = -200 + Math.random()*400
    intery = -200 + Math.random()*400
    lines.push({points:[{"x": randx1,   "y": randy1},{ "x": (randx1+randx2)/2+interx,  "y": (randy1+randy2)/2+intery}, { "x": randx2,  "y": randy2}]})
    randx1 = randx2
    randy1 = randy2
    dot.push({x:randx1, y:randy1, r:5})
  }
  graph = {nodes:dot, links:lines}*/
  graph = {nodes:[], links:[]}

var rawdata = {"nodes": [{"Y": -297.2867411458227, "X": -172.2102735685785, "name": 0, "id": 0}, {"Y": -156.64468288725016, "X": -483.03254969373415, "name": 1, "id": 1}, {"Y": -81.4000817614733, "X": -135.45708333714379, "name": 2, "id": 2}, {"Y": -527.9813678428229, "X": -102.80714081879364, "name": 3, "id": 3}, {"Y": -51.11977926873806, "X": 261.24418576590233, "name": 4, "id": 4}, {"Y": -549.398979901107, "X": 411.0197560631109, "name": 5, "id": 5}, {"Y": -442.3050947406531, "X": -274.2146836628269, "name": 6, "id": 6}, {"Y": -574.309879510981, "X": -350.94855536526006, "name": 7, "id": 7}, {"Y": -670.2698611540642, "X": -275.99682658637266, "name": 8, "id": 8}, {"Y": -711.9537003488138, "X": -142.47880204277612, "name": 9, "id": 9}, {"Y": -321.1148608655624, "X": -582.2613280162983, "name": 10, "id": 10}, {"Y": 205.49252000568708, "X": -546.1837905328076, "name": 11, "id": 11}, {"Y": -353.11574161475835, "X": -407.6305935547218, "name": 12, "id": 12}, {"Y": 21.385993984638844, "X": 46.08502688269277, "name": 13, "id": 13}, {"Y": 57.32511274225294, "X": -203.63794767671948, "name": 14, "id": 14}, {"Y": -117.78008599712655, "X": 34.2811612545936, "name": 15, "id": 15}, {"Y": 171.70184985842843, "X": 18.856348907642996, "name": 16, "id": 16}, {"Y": 211.17233128066914, "X": -99.2186321291963, "name": 17, "id": 17}, {"Y": 145.159937004295, "X": 266.6957881427295, "name": 18, "id": 18}, {"Y": 35.85646464351498, "X": 130.42395411729922, "name": 19, "id": 19}, {"Y": 96.16499932359989, "X": 441.8662652978453, "name": 20, "id": 20}, {"Y": -314.32726741296733, "X": 281.976834740035, "name": 21, "id": 21}, {"Y": -156.66165484584826, "X": 363.2590511300898, "name": 22, "id": 22}, {"Y": -61.47638009217235, "X": 486.81446826971114, "name": 23, "id": 23}, {"Y": 211.6695578743438, "X": -772.4363707522027, "name": 24, "id": 24}, {"Y": -49.25124661822031, "X": -657.7278006871088, "name": 25, "id": 25}, {"Y": -11.833840850345723, "X": -836.0021820290644, "name": 26, "id": 26}, {"Y": 342.2571834137391, "X": -378.0481838762669, "name": 27, "id": 27}, {"Y": -1.9011483301994758, "X": -423.72219664117904, "name": 28, "id": 28}, {"Y": 357.7153223450198, "X": -714.7771271246627, "name": 29, "id": 29}, {"Y": 415.8355203481135, "X": -549.7810736070768, "name": 30, "id": 30}, {"Y": 158.1191938427762, "X": -346.2135235622127, "name": 31, "id": 31}, {"Y": -413.7761199895167, "X": 138.20374298492152, "name": 32, "id": 32}, {"Y": -837.9244495005776, "X": 193.32649154826868, "name": 33, "id": 33}, {"Y": -680.1572135491996, "X": 39.16966830446859, "name": 34, "id": 34}, {"Y": -699.6147392673847, "X": 544.3579685247164, "name": 35, "id": 35}, {"Y": -541.6365998642127, "X": 660.0904232881755, "name": 36, "id": 36}, {"Y": -384.410502862655, "X": 548.8247032651402, "name": 37, "id": 37}, {"Y": -372.6376609040543, "X": 371.41028800189065, "name": 38, "id": 38}, {"Y": -792.3484634704653, "X": 418.33741472531347, "name": 39, "id": 39}, {"Y": 405.54931428527016, "X": -152.51608233357342, "name": 40, "id": 40}], "links": [{"sizeParticule": "10", "target": 1,  "color": "black", "temporal": [0.4], "OLDTARGET": 1, "source": 0, "shape": "rectangle", "frequency": 0.25, "speed": 13.034, "id": 0}, {"sizeParticule": "10", "target": 2,  "color": "black", "temporal": [0.2], "OLDTARGET": 3, "source": 0, "shape": "rectangle", "frequency": 0.25, "speed": 3.61, "id": 1}, {"sizeParticule": "10", "target": 3,  "color": "black", "temporal": [0.3], "OLDTARGET": 5, "source": 0, "shape": "rectangle", "frequency": 0.25, "speed": 6.86, "id": 2}, {"sizeParticule": "10", "target": 4,  "color": "black", "temporal": [0.5], "OLDTARGET": 38, "source": 3, "shape": "rectangle", "frequency": 0.25, "speed": 24.8, "id": 3}, {"sizeParticule": "10", "target": 5,  "color": "black", "temporal": [0.1], "OLDTARGET": 7, "source": 3, "shape": "rectangle", "frequency": 0.25, "speed": 1.9, "id": 4}, {"sizeParticule": "10", "target": 6,  "color": "black", "temporal": [0.0], "OLDTARGET": 14, "source": 3, "shape": "rectangle", "frequency": 0.25, "speed": 1, "id": 5}, {"sizeParticule": "10", "target": 7,  "color": "black", "temporal": [0.3], "OLDTARGET": 21, "source": 3, "shape": "rectangle", "frequency": 0.25, "speed": 6.86, "id": 6}, {"sizeParticule": "10", "target": 8, "OLDSOURCE": 1, "color": "black", "temporal": [0.5], "OLDTARGET": 2, "source": 3, "shape": "rectangle", "frequency": 0.25, "speed": 24.8, "id": 7}, {"sizeParticule": "10", "target": 9, "OLDSOURCE": 1, "color": "black", "temporal": [0.4], "OLDTARGET": 4, "source": 3, "shape": "rectangle", "frequency": 0.25, "speed": 13.034, "id": 8}, {"sizeParticule": "10", "target": 10, "OLDSOURCE": 4, "color": "black", "temporal": [0.0], "OLDTARGET": 32, "source": 1, "shape": "rectangle", "frequency": 0.25, "speed": 1, "id": 9}, {"sizeParticule": "10", "target": 11, "OLDSOURCE": 4, "color": "black", "temporal": [0.2], "OLDTARGET": 35, "source": 1, "shape": "rectangle", "frequency": 0.25, "speed": 3.61, "id": 10}, {"sizeParticule": "10", "target": 12, "OLDSOURCE": 4, "color": "black", "temporal": [0.1], "OLDTARGET": 6, "source": 1, "shape": "rectangle", "frequency": 0.25, "speed": 1.9, "id": 11}, {"sizeParticule": "10", "target": 13, "OLDSOURCE": 4, "color": "black", "temporal": [0.4], "OLDTARGET": 11, "source": 2, "shape": "rectangle", "frequency": 0.25, "speed": 13.034, "id": 12}, {"sizeParticule": "10", "target": 14, "OLDSOURCE": 4, "color": "black", "temporal": [0.5], "OLDTARGET": 16, "source": 2, "shape": "rectangle", "frequency": 0.25, "speed": 24.8, "id": 13}, {"sizeParticule": "10", "target": 15, "OLDSOURCE": 5, "color": "black", "temporal": [0.1], "OLDTARGET": 34, "source": 2, "shape": "rectangle", "frequency": 0.25, "speed": 1.9, "id": 14}, {"sizeParticule": "10", "target": 16, "OLDSOURCE": 5, "color": "black", "temporal": [0.0], "OLDTARGET": 36, "source": 2, "shape": "rectangle", "frequency": 0.25, "speed": 1, "id": 15}, {"sizeParticule": "10", "target": 17, "OLDSOURCE": 5, "color": "black", "temporal": [0.3], "OLDTARGET": 8, "source": 2, "shape": "rectangle", "frequency": 0.25, "speed": 6.86, "id": 16}, {"sizeParticule": "10", "target": 18, "OLDSOURCE": 5, "color": "black", "temporal": [0.2], "OLDTARGET": 9, "source": 4, "shape": "rectangle", "frequency": 0.25, "speed": 3.61, "id": 17}, {"sizeParticule": "10", "target": 19, "OLDSOURCE": 5, "color": "black", "temporal": [0.5], "OLDTARGET": 10, "source": 4, "shape": "rectangle", "frequency": 0.25, "speed": 24.8, "id": 18}, {"sizeParticule": "10", "target": 20, "OLDSOURCE": 5, "color": "black", "temporal": [0.2], "OLDTARGET": 12, "source": 4, "shape": "rectangle", "frequency": 0.25, "speed": 3.61, "id": 19}, {"sizeParticule": "10", "target": 21, "OLDSOURCE": 5, "color": "black", "temporal": [0.0], "OLDTARGET": 40, "source": 4, "shape": "rectangle", "frequency": 0.25, "speed": 1, "id": 20}, {"sizeParticule": "10", "target": 22, "OLDSOURCE": 5, "color": "black", "temporal": [0.1], "OLDTARGET": 20, "source": 4, "shape": "rectangle", "frequency": 0.25, "speed": 1.9, "id": 21}, {"sizeParticule": "10", "target": 23, "OLDSOURCE": 5, "color": "black", "temporal": [0.4], "OLDTARGET": 27, "source": 4, "shape": "rectangle", "frequency": 0.25, "speed": 13.034, "id": 22}, {"sizeParticule": "10", "target": 24, "OLDSOURCE": 5, "color": "black", "temporal": [0.3], "OLDTARGET": 31, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 6.86, "id": 23}, {"sizeParticule": "10", "target": 25, "OLDSOURCE": 6, "color": "black", "temporal": [0.4], "OLDTARGET": 25, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 13.034, "id": 24}, {"sizeParticule": "10", "target": 26, "OLDSOURCE": 7, "color": "black", "temporal": [0.5], "OLDTARGET": 13, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 24.8, "id": 25}, {"sizeParticule": "10", "target": 27, "OLDSOURCE": 8, "color": "black", "temporal": [0.2], "OLDTARGET": 26, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 3.61, "id": 26}, {"sizeParticule": "10", "target": 28, "OLDSOURCE": 13, "color": "black", "temporal": [0.0], "OLDTARGET": 15, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 1, "id": 27}, {"sizeParticule": "10", "target": 29, "OLDSOURCE": 13, "color": "black", "temporal": [0.1], "OLDTARGET": 17, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 1.9, "id": 28}, {"sizeParticule": "10", "target": 30, "OLDSOURCE": 13, "color": "black", "temporal": [0.3], "OLDTARGET": 19, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 6.86, "id": 29}, {"sizeParticule": "10", "target": 31, "OLDSOURCE": 13, "color": "black", "temporal": [0.1], "OLDTARGET": 28, "source": 11, "shape": "rectangle", "frequency": 0.25, "speed": 1.9, "id": 30}, {"sizeParticule": "10", "target": 32, "OLDSOURCE": 13, "color": "black", "temporal": [0.5], "OLDTARGET": 29, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 24.8, "id": 31}, {"sizeParticule": "10", "target": 33, "OLDSOURCE": 16, "color": "black", "temporal": [0.2], "OLDTARGET": 18, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 3.61, "id": 32}, {"sizeParticule": "10", "target": 34, "OLDSOURCE": 17, "color": "black", "temporal": [0.0], "OLDTARGET": 33, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 1, "id": 33}, {"sizeParticule": "10", "target": 35, "OLDSOURCE": 17, "color": "black", "temporal": [0.3], "OLDTARGET": 39, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 6.86, "id": 34}, {"sizeParticule": "10", "target": 36, "OLDSOURCE": 18, "color": "black", "temporal": [0.4], "OLDTARGET": 24, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 13.034, "id": 35}, {"sizeParticule": "10", "target": 37, "OLDSOURCE": 18, "color": "black", "temporal": [0.1], "OLDTARGET": 22, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 1.9, "id": 36}, {"sizeParticule": "10", "target": 38, "OLDSOURCE": 22, "color": "black", "temporal": [0.3], "OLDTARGET": 23, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 6.86, "id": 37}, {"sizeParticule": "10", "target": 39, "OLDSOURCE": 29, "color": "black", "temporal": [0.4], "OLDTARGET": 30, "source": 5, "shape": "rectangle", "frequency": 0.25, "speed": 13.034, "id": 38}, {"sizeParticule": "10", "target": 40, "OLDSOURCE": 36, "color": "black", "temporal": [0.2], "OLDTARGET": 37, "source": 14, "shape": "rectangle", "frequency": 0.25, "speed": 3.61, "id": 39}], "multigraph": false}

for (var i = 0; i < rawdata.nodes.length; i++) {
  graph.nodes.push( {x:rawdata.nodes[i].X+950,y:rawdata.nodes[i].Y+850,r:5})
}
for (var i = 0; i < rawdata.links.length; i++) {
  source = null
  target = null
  for (var j = 0; j < rawdata.nodes.length; j++) {
    if ( rawdata.nodes[j].id === rawdata.links[i].source ) source = {x:rawdata.nodes[j].X+950,y:rawdata.nodes[j].Y+850}
    if ( rawdata.nodes[j].id === rawdata.links[i].target ) target = {x:rawdata.nodes[j].X+950,y:rawdata.nodes[j].Y+850}
  }
  graph.links.push( {id:i, points:[source,target]})
}


  flownetGraph = new flownet_d3_graph(graph, document.getElementById('canvas'))


  var frequencySlider = document.getElementById("frequencySlider");
  frequencySlider.oninput = function() {
      for (var i = 0; i < graph.links.length; i++) {
        graph.links[i].frequencyParticule = this.value
        flownetGraph.updateFrequencyPraticule()
      }
  }
  var speedSlider = document.getElementById("speedSlider");
  speedSlider.oninput = function() {
      for (var i = 0; i < graph.links.length; i++) {
        graph.links[i].speedParticule = this.value
        flownetGraph.updateSpeedPraticule()
      }
  }
  var patternSlider = document.getElementById("patternSlider");
  patternSlider.oninput = function() {
      pattern = [ [10],[4,2,4],[5,5,20,8,2],[4,2,12],[8,1,8,1,8,1,8,1,8] ]
      for (var i = 0; i < graph.links.length; i++) {
        graph.links[i].patternParticule = pattern[this.value]
        flownetGraph.updatePatternPraticule()
      }
  }
  var colorSlider = document.getElementById("colorSlider");
  colorSlider.oninput = function() {
    color = ["red", "blue","green", "yellow", "orange", "purple"]
      for (var i = 0; i < graph.links.length; i++) {
        graph.links[i].colorParticule = color[this.value]
        flownetGraph.updateColorPraticule()
      }
  }
  var sizeSlider = document.getElementById("sizeSlider");
  sizeSlider.oninput = function() {
      for (var i = 0; i < graph.links.length; i++) {
        graph.links[i].sizeParticule = this.value
        //graph.links[i].sizeLink = this.value+2
      }
      flownetGraph.updateSizePraticule()
      //flownetGraph.updateSizeLink()
  }

  flownetGraph.bindCallbackOnLink(function(d){
    flownetGraph.addColorGate(this, d, "red")
  }, "click")
  flownetGraph.bindCallbackOnLink(function(d){
    this.setAttribute('stroke', 'skyblue');
  }, "mouseover")
  flownetGraph.bindCallbackOnLink(function(d){
    this.setAttribute('stroke', d.colorLink);
  }, "mouseleave")
	</script>



</html>
